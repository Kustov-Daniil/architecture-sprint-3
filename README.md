
# Задание 1. Анализ и планирование

## 1.  Изучите функциональность монолитного приложения:
    
*   **Управление отоплением.** Пользователи могут удалённо включать/выключать отопление в своих домах.
        
*   **Мониторинг температуры.** Система получает данные о температуре с датчиков, установленных в домах. Пользователи могут просматривать текущую температуру в своих домах через веб-интерфейс.
        
## 2.  Проанализируйте архитектуру монолитного приложения:
    
*   **Язык программирования:** Java
        
*   **База данных:** PostgreSQL
        
*   **Архитектура:** Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения.
        
*   **Взаимодействие:** Синхронное, запросы обрабатываются последовательно.
        
*   **Масштабируемость:** Ограничена, так как монолит сложно масштабировать по частям.
        
*   **Развёртывание:** Требует остановки всего приложения.
        

## 3.  Определение доменов и границ контекстов
*  **Управление отоплением (Heating Control):** Обработка запросов на включение и выключение отопления. Управляет состоянием устройства отопления в домах.
    
*  **Мониторинг температуры (Temperature Monitoring):** Получает и обрабатывает данные о температуре из установленных датчиков, хранит их и предоставляет доступ для пользователей.
        
*  **Управление устройствами (Device Management):** Домен для подключения и управления устройствами. В будущем он будет ответственен за поддержку и настройку различных устройств (например, освещение, камеры, ворота).
        
*  **Аутентификация и авторизация (Authentication & Authorization):** Обеспечивает безопасность, управляет доступом пользователей к системе, их правами и сессиями.
    
*  **Управление уведомлениями (Notification Management):** Домен для обработки и отправки уведомлений пользователям о статусе системы, например, уведомлений о текущем статусе температурного режима или о том, что датчик вышел из строя.
    

## 4.  Анализ проблем монолитного приложения

Монолитная архитектура приложения имеет несколько недостатков, особенно в контексте целей по расширению функциональности и масштабирования

* **Сложность масштабирования:** С монолитной структурой невозможно гибко масштабировать отдельные компоненты системы.
        
* **Ограниченная гибкость и расширяемость:** Сложность добавления новой функциональности (например, управление другими устройствами) и поддержки системы.
        
* **Проблемы с развёртыванием и обновлениями:** Развёртывание новой версии требует остановки всего приложения, что может приводить к простоям.
        
* **Низкая отказоустойчивость:** В случае отказа одной функции, например, мониторинга температуры, может нарушиться работа всей системы.
        
* **Зависимость от синхронного взаимодействия:** Ограничения, связанные с использованием синхронных операций.
    

Текущая монолитная архитектура представляет собой ограничение для реализации бизнес-целей компании, поскольку затрудняет внедрение новых функций и управление масштабированием.

## 5. Визуализация контекста системы (Context Diagram)

C4 - Уровень контекста (Context) - 1_Monolith_Context_Diagram.puml









# Задание 2. Проектирование микросервисной архитектуры

## 1. Декомпозиция приложения на микросервисы

Основываясь на выделенных доменах и бизнес-целях, микросервисы можно разделить следующим образом:

#### Основные микросервисы

1.  **Heating Control (Управление отоплением):**
    
*   Управляет включением и выключением отопления.
        
*   Поддерживает сценарии работы в зависимости от внешних условий и предпочтений пользователя.
        
2.  **Temperature Monitoring (Мониторинг температуры):**
    
*   Получает данные о температуре с датчиков и сохраняет их для дальнейшего использования.
        
*   Предоставляет данные в реальном времени для просмотра пользователем.
        
3.  **Device Management (Управление устройствами):**
    
*   Управляет подключением новых устройств, таких как освещение, ворота и т.д.
        
*   Поддерживает работу с устройствами партнёров по стандартным протоколам.
        
4.  **User Management (Управление пользователями):**
    
*   Обеспечивает регистрацию, аутентификацию и авторизацию пользователей.
        
*   Управляет правами и настройками пользователя для управления их устройствами.
        
5.  **Notification Service (Служба уведомлений):**
    
*   Отправляет уведомления пользователям (например, об изменении температуры, неисправностях и т.д.).
        
*   Поддерживает несколько каналов уведомлений, таких как e-mail, push-уведомления и SMS.
        
6.  **Scenario Management (Управление сценариями):**
    
*   Позволяет пользователям создавать и управлять сценариями автоматизации (например, включение света при открытии ворот или включение отопления при низкой температуре).
        
*   Обеспечивает возможность гибкой настройки сценариев.
        
7.  **Logging & Monitoring (Логирование и мониторинг):**
    
*   Сохраняет логи и метрики для аналитики и диагностики системы.
        
*   Поддерживает централизованное хранилище для логов всех микросервисов и аналитических данных.
        

#### Дополнительные компоненты архитектуры

1.  **API Gateway:** обеспечивает единый точку входа для всех клиентских запросов, управляет маршрутизацией к микросервисам, обеспечивает аутентификацию и авторизацию, и может выполнять базовую обработку запросов.
    
2.  **Message Broker (Kafka):** используется для асинхронного обмена сообщениями между микросервисами, что повышает гибкость и надёжность системы.
    

## 2. Взаимодействия между компонентами

#### Основные взаимодействия:

1.  **API Gateway и микросервисы:**
    
*   API Gateway будет обрабатывать все внешние запросы (от мобильных и веб-клиентов) и направлять их к соответствующим микросервисам.
        
*   Он также обрабатывает аутентификацию и авторизацию пользователей.
        
2.  **Микросервисы и Kafka:**
    
Микросервисы используют Kafka для публикации и подписки на события. Например:
        
*   **Temperature Monitoring** публикует обновления температуры, на которые подписаны **Heating Control** и **Notification Service**.
            
*   **Device Management** публикует события о подключении новых устройств, которые могут обрабатываться другими микросервисами, например, для автоматической настройки уведомлений.
            
3.  **Микросервисы и база данных:**
    
Каждый микросервис имеет свою собственную базу данных. Например:
        
*   **User Management** — база данных для информации о пользователях и их учетных данных.
            
*   **Temperature Monitoring** — база данных для хранения истории температурных данных.
            

## 3. Визуализация архитектуры:

*   C4 — Уровень контейнеров (Containers) - 2_TOBE_Container.puml
*   C4 — Уровень компонентов (Components) - 3_TOBE_Components.puml

Пример диаграммы Components для сервиса Device Management Service 
*   C4 — Уровень кода (Code) - 4_TOBE_Code.puml

Пример диаграммы Code для сценария добавления нового устройства.




вава



